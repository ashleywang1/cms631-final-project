<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Car Fuel Efficiency Quiz</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.css">
    <style>
      body {
        position: absolute;
        top: 0; bottom: 0;
        left: 0; right: 0;
      }

      select {
        margin: 10px;
        padding: 10px;
      }

      .example_car {
        width: 100px;
        height: 100px;
        padding: 0.5em;
        float: left;
        margin: 110px 10px 10px 30px;
      }

      .example_car img{
        width: 100%;
      }

      .percentile {
        display: inline-block;
        width: 19.5%;
        height: 100%;
      }

      #draggable {
        width: 100px;
        height: 100px;
        padding: 0.5em;
        float: left;
        margin: 10px 10px 10px 0;
      }

      #draggable img{
        width: 100%;
        cursor: pointer;
      }

      #getYourCar {
        margin: 10px;
      }

      #getRandomCar {
        margin: 10px;
      }

      .carLabel {
        font-size: 12px;
      }

      #droppable {
        width: 100%;
        height: 150px; 
        float: left; 
      }
    </style>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="../js/car_data.js"></script>
    <script>

      function getCarOptions(mfr) {
        return car_data.filter(
          function(c){ return c.mfr == mfr }
        );
      }

      $( function() {
        // Set up the car selection
        metadata.forEach(function(c) {
          $("#manufacturer").append("<option>" + c.mfr +"</option>");
        });

        getCarOptions("aston martin").forEach(function(c) {
          $("#carType").append("<option>" + c.car + "</option>");
          // console.log(c.car);
        })

        // Set up the drag and drop game
        $( "#draggable" ).draggable();
        $( "#droppable" ).droppable({
          drop: function( event, ui ) {
            var OFFSET = 20;
            var percentage = ((ui.offset.left + OFFSET)/$( this ).width())*100;
            $( this )
              // .addClass( "ui-state-highlight" )
              .find( "p" )
                .html(percentage.toFixed(0) + "%");
          }
        });

        // Set up selection and button handlers
        document.getElementById("manufacturer").onchange = function(e) {
          var mfr = $("#manufacturer")[0].options[e.target.selectedIndex].value
          $("#carType").html("");
          getCarOptions(mfr).forEach(function(c) {
            $("#carType").append("<option>" + c.car + "</option>");
          });
        };

        document.getElementById("getYourCar").onclick = function(e) {
          $("#draggable").html("");
          var mfr = $("#manufacturer")[0].options[$("#manufacturer")[0].selectedIndex].text
          var car = $("#carType")[0].options[$("#carType")[0].selectedIndex].text
          $("#draggable").append("<img src='../img/yCar.png'/><center><label class='carLabel'>" + mfr + " " + car + "</label></center>");
        }
        document.getElementById("getRandomCar").onclick = function(e) {
          $("#draggable").html("");
          $("#draggable").append("<img src='../img/yCar.png'/><center><label class='carLabel'>Your car</label></center>");
        }

      });

    </script>
  </head>
  <body>
    <div id="instructions" width="50%">
      <h1>Do you know your car's fuel efficiency score?</h1>
    </div>
    <div id="garage" width="50%">
      <p>Enter your car's information here.</p>
      <select name="manufactuer" id="manufacturer">
      </select>
      <select name="carType" id="carType">
      </select>
      <button type="button" class="btn btn-default" id="getYourCar"> Get your car </button>
      <br>
      <button type="button" class="btn btn-default" id="getRandomCar"> Get a random car </button>
    </div>
    <div id="draggable"></div>
     
    <div id="droppable">
      <p style="position: absolute;">Drag your car here</p>
      <!-- ["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"] -->
      <div class="percentile" style="background:#edf8e9">
        <div class="example_car">
          <img src="../img/lamborghini.png" />
          <center><label class="carLabel">Lamborghini</label></center>
        </div>
      </div>
      <div class="percentile" style="background:#bae4b3">
        <div class="example_car">
          <img src="../img/ford_focus.png" />
          <center><label class="carLabel">Ford Focus</label></center>
        </div>
      </div>
      <div class="percentile" style="background:#74c476">
        <div class="example_car">
          <img src="../img/audi.png" />
          <center><label class="carLabel">Volkswagon Audi</label></center>
        </div>
      </div>
      <div class="percentile" style="background:#31a354">
        <div class="example_car">
          <img src="../img/honda_accord.png" />
          <center><label class="carLabel">Honda Accord</label></center>
        </div>
      </div>
      <div class="percentile" style="background:#006d2c">
        <div class="example_car">
          <img src="../img/toyota_prius.png" />
          <center><label class="carLabel">Toyota Prius</label></center>
        </div>
      </div>
    </div>
  </body>
</html>